"0","# Define plot heights and widths (including group titles)"
"0","wds = c((sum(xglns)*xttl_height),xglns)"
"0","hts = c(yglns,(sum(yglns)*yttl_width ))"
"0",""
"0","# Define plot spacer"
"0","ps = plot_spacer()"
"0",""
"0","# Create empty lists to be populated with plot titles"
"0","xttls = list()"
"0","yttls = list()"
"0",""
"0","# Define plot titles"
"0","for (xgrp in 1:length(xgrps)) {"
"0","  xttls[[xgrp]] = plt_ttl(xgrps[xgrp])"
"0","}"
"0","for (ygrp in 1:length(ygrps)) {"
"0","  yttls[[ygrp]] = plt_ttl(ygrps[ygrp],axs=""y"")"
"0","}"
"0",""
"0","# Create empty list to populate with both plot title and heatmap tiles in the correct order"
"0","plts = list()"
"0",""
"0","# Define counters for subsetting plot title and heatmap lists, to ensure they are ordered correctly"
"0","i = 1"
"0","j = 1"
"0",""
"0","# For each group (row), assign each plot title, then the heatmap tiles within that row to plts list"
"0","for (ygrp in 1:length(yttls)) {"
"0","  "
"0","  # Add plot title to list"
"0","  plts[[i]] = yttls[[ygrp]]"
"0","  "
"0","  # Add heatmap plots to list"
"0","  plts[(i+1):(i+length(xttls))] = pl[j:(j+length(xttls)-1)]"
"0","  "
"0","  # Adjust counters"
"0","  i = i + 1 + length(xttls)"
"0","  j = j +     length(xttls)"
"0","}"
"0",""
"0","# Add x-axis plots"
"0","plts[[length(plts)+1]] = ps"
"0","plts[(length(plts)+1):(length(plts)+length(xttls))] = xttls"
"0",""
"0","# Define final plot"
"0","plt = patchwork::wrap_plots(plts, widths = wds, heights = hts, guides = ""collect"")"
"0",""
"0","plt"
